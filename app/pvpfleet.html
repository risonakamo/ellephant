<link rel="import" href="polymer/polymer/polymer-element.html">

<dom-module id="pvp-fleet">
  <template>
    <style>
      :host
      {
        position: relative;
        display: inline-block;
        width: 700px;        
        height: 100px;
        font-size: 0;
        overflow: hidden;
        user-select: none;
        cursor: default;
      }

      :host div
      {
        display: inline-block;        
        vertical-align: top;
      }

      .info
      {
        position: relative;
        width: 160px;
        height: 100px;
        text-align: center;
      }

      .name
      {
        width: 100%;
        height: 30px;
        line-height: 30px;
        font-size: 23px;
        margin-top: 23px;
      }

      .rank
      {
        font-size: 19px;
        color: #41a669;
      }

      .border
      {
        position: absolute;
        width: 70%;
        bottom: 0;
        left: 15%;
        border-bottom: 1px solid #736f6c;
      }

      .ship
      {        
        width: 90px;
        height: 100px;
        background-color: rgba(50,51,43,.4);
        transition: transform .4s;
      }

      .ship .face-contain
      {
        width: 90px;
        height: 81px;
        background-color: rgba(94,102,104,.1);
      }

      .ship img
      {
        height: 100%;
        opacity: 1;
        transition: opacity .2s;
      }      

      .ship .label
      {        
        width: 100%;
        height: 19px;
        line-height: 19px;
        font-family: var(--label-font);
        font-size: 19px;
        text-align: center;
        color: #d2d4d1;
      }

      .ship.unloaded
      {
        transform: translateY(100px);
      }

      #unload-sign
      {
        position: absolute;
        width: 450px;
        height: 100px;
        line-height: 100px;
        color: #1e3717;
        background-color: rgba(50,51,43,.1);
        font-size: 30px;
        text-align: center;        
        bottom: 0;
        right: 0;
        transition: opacity .4s;
      }

      .hidden
      {
        opacity: 0;
      }
    </style>

    <div class="info">
      <div class="name">
        [[name]]
      </div>

      <div class="rank">
        [[rank]]
      </div>

      <div class="border"></div>        
    </div>    

    <div id="ships">
      <div class="ship">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>

      <div class="ship unloaded">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>

      <div class="ship unloaded">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>
      
      <div class="ship unloaded">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>

      <div class="ship unloaded">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>

      <div class="ship unloaded">
        <div class="face-contain">
          <img>
        </div>

        <div class="label"></div>
      </div>
    </div>

    <div id="unload-sign">
      UNLOADED
    </div>

  </template>

  <script>
    class pvpFleet extends Polymer.Element
    {
      static get is()
      {
        return "pvp-fleet";
      }

      /*private variables        
        name: string of enemy name
        rank: enemy level
        shipFaces: array of shipface img elements
        shipLabels: array of ship label elements
        ships: array of ship elements
      */
      static get properties()
      {
        return {

        };
      }

      ready()
      {
        super.ready();

        this.shipFaces=this.$["ships"].querySelectorAll(".ship img");
        this.shipLabels=this.$["ships"].querySelectorAll(".label");
        this.ships=this.$["ships"].querySelectorAll(".ship");
      }

      //give it entire enemy object from api list practice api_list
      initialLoad(data)
      {
        this.shipFaces[0].src=`face/${data.api_enemy_flag_ship}.png`;
        this.name=data.api_enemy_name;
        this.rank=data.api_enemy_level;        
      }

      fleetLoad(data)
      {
        for (var x=0;x<6;x++)
        {
          if (data[x].api_id<0)
          {
            break;
          }

          if (x>0)
          {
            this.shipFaces[x].src=`face/${data[x].api_ship_id}.png`;
          }

          this.shipLabels[x].innerHTML=`${data[x].type} Lv${data[x].api_level}`;
        }

        this.$["unload-sign"].classList.add("hidden");
        this.animateIn(0);
      }

      animateIn(index)
      {
        this.ships[index].classList.remove("unloaded");

        if (index>=5)
        {
          return;
        }

        setTimeout(()=>{this.animateIn(index+1)},70);
      }
    }

    customElements.define(pvpFleet.is,pvpFleet);
  </script>
</dom-module>